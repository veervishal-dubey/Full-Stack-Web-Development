<!DOCTYPE html>
<html>
<head>
<title>Dashboard | RTRWH</title>
<link rel="stylesheet" href="css/style.css">
</head>
<body>
<script src="js/rain.js"></script>
<nav>
  <div class="logo">ğŸŒ§ï¸ RTRWH</div>
  <div>
    <a href="index.html">Home</a>
    <a href="about.html">About</a>
    <a href="calculate.html">Calculate</a>
    <a href="report.html">Report</a>
    <a href="dashboard.html">Dashboard</a>
    <a href="login.html">Login</a>
    <a href="signup.html">Signup</a>
  </div>
</nav>


<section class="page">
<h1>Dashboard & Visualization</h1>
<p>This dashboard shows your estimated water storage, harvesting efficiency, and usage distribution.</p>

<div class="dashboard">
  <div class="chart-card">
    <h2>Monthly Harvest (Litres)</h2>
    <canvas id="rainChart"></canvas>
  </div>

  <div class="chart-card tank-wrapper">
    <h2>ğŸ’§ Storage Tank Simulation</h2>
    <div class="tank"><div class="water" id="waterFill"></div></div>
    <div class="tank-label" id="tankText">Tank Filled: 70%</div>
    <p>This visualizes how much water can be stored and used effectively.</p>
  </div>
</div>
</section>

<script src="https://cdn.jsdelivr.net/npm/gsap@3/dist/gsap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
gsap.fromTo(".page",{opacity:0,y:40},{opacity:1,y:0,duration:1.2,clearProps:"all"});

const API_BASE = "http://localhost:5000";

fetch(`${API_BASE}/rainfall`)
  .then(res => res.json())
  .then(data => {

    const labels = data.map(row => row.location);
    const rainfallValues = data.map(row => row.avg_rainfall);

    const ctx = document.getElementById('rainChart').getContext('2d');

    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: labels,
        datasets: [{
          label: 'Average Rainfall (mm/year)',
          data: rainfallValues,
          backgroundColor: 'rgba(79,195,247,0.8)'
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: { beginAtZero: true }
        }
      }
    });

  })
  .catch(err => {
    console.error(err);
  });


document.getElementById("waterFill").style.height="70%";
</script>
</body>
</html>
